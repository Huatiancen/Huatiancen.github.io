<!-- å¤©æ°”å°ç»„ä»¶ -->
<div class="weather-widget">
  <div class="weather-header">
    <i class="fas fa-cloud-sun"></i>
    <span>ä»Šæ—¥å¤©æ°”</span>
    <button class="weather-refresh" onclick="refreshWeather()" title="åˆ·æ–°">
      <i class="fas fa-sync-alt"></i>
    </button>
  </div>
  
  <div class="weather-content">
    <div class="weather-main">
      <div class="weather-icon" id="weather-icon">â˜€ï¸</div>
      <div class="weather-temp">
        <span id="weather-temp">23</span>Â°C
      </div>
    </div>
    
    <div class="weather-info">
      <div class="weather-desc" id="weather-desc">æ™´æœ—</div>
      <div class="weather-location">
        <i class="fas fa-map-marker-alt"></i>
        <span id="weather-location">åŒ—äº¬</span>
      </div>
    </div>
    
    <div class="weather-details">
      <div class="weather-item">
        <i class="fas fa-eye"></i>
        <span>èƒ½è§åº¦</span>
        <span id="visibility">10km</span>
      </div>
      <div class="weather-item">
        <i class="fas fa-tint"></i>
        <span>æ¹¿åº¦</span>
        <span id="humidity">65%</span>
      </div>
      <div class="weather-item">
        <i class="fas fa-wind"></i>
        <span>é£é€Ÿ</span>
        <span id="wind-speed">12km/h</span>
      </div>
    </div>
  </div>
</div>

<script>
// å¤©æ°”æ•°æ®åº“ï¼ˆæ¨¡æ‹Ÿï¼‰
const weatherData = [
  {
    location: "åŒ—äº¬",
    temp: 23,
    desc: "æ™´æœ—",
    icon: "â˜€ï¸",
    visibility: "10km",
    humidity: "65%",
    windSpeed: "12km/h"
  },
  {
    location: "ä¸Šæµ·",
    temp: 26,
    desc: "å¤šäº‘",
    icon: "â›…",
    visibility: "8km",
    humidity: "72%",
    windSpeed: "8km/h"
  },
  {
    location: "å¹¿å·",
    temp: 28,
    desc: "å°é›¨",
    icon: "ğŸŒ¦ï¸",
    visibility: "6km",
    humidity: "85%",
    windSpeed: "15km/h"
  },
  {
    location: "æ·±åœ³",
    temp: 27,
    desc: "é˜µé›¨",
    icon: "ğŸŒ§ï¸",
    visibility: "5km",
    humidity: "88%",
    windSpeed: "18km/h"
  },
  {
    location: "æ­å·",
    temp: 24,
    desc: "æ™´è½¬å¤šäº‘",
    icon: "ğŸŒ¤ï¸",
    visibility: "9km",
    humidity: "68%",
    windSpeed: "10km/h"
  },
  {
    location: "æˆéƒ½",
    temp: 22,
    desc: "é˜´å¤©",
    icon: "â˜ï¸",
    visibility: "7km",
    humidity: "78%",
    windSpeed: "6km/h"
  },
  {
    location: "è¥¿å®‰",
    temp: 20,
    desc: "æ™´æœ—",
    icon: "â˜€ï¸",
    visibility: "12km",
    humidity: "55%",
    windSpeed: "14km/h"
  },
  {
    location: "å—äº¬",
    temp: 25,
    desc: "å¤šäº‘è½¬æ™´",
    icon: "â›…",
    visibility: "9km",
    humidity: "70%",
    windSpeed: "11km/h"
  }
];

let currentWeatherIndex = 0;

// åˆ·æ–°å¤©æ°”ä¿¡æ¯
function refreshWeather() {
  const refreshButton = document.querySelector('.weather-refresh');
  refreshButton.classList.add('rotating');
  
  // éšæœºé€‰æ‹©ä¸€ä¸ªåŸå¸‚çš„å¤©æ°”
  currentWeatherIndex = Math.floor(Math.random() * weatherData.length);
  const weather = weatherData[currentWeatherIndex];
  
  // æ·»åŠ è¿‡æ¸¡æ•ˆæœ
  const elements = [
    document.getElementById('weather-icon'),
    document.getElementById('weather-temp'),
    document.getElementById('weather-desc'),
    document.getElementById('weather-location'),
    document.getElementById('visibility'),
    document.getElementById('humidity'),
    document.getElementById('wind-speed')
  ];
  
  // æ·¡å‡º
  elements.forEach(el => {
    if (el) el.style.opacity = '0';
  });
  
  setTimeout(() => {
    // æ›´æ–°æ•°æ®
    if (document.getElementById('weather-icon')) document.getElementById('weather-icon').textContent = weather.icon;
    if (document.getElementById('weather-temp')) document.getElementById('weather-temp').textContent = weather.temp;
    if (document.getElementById('weather-desc')) document.getElementById('weather-desc').textContent = weather.desc;
    if (document.getElementById('weather-location')) document.getElementById('weather-location').textContent = weather.location;
    if (document.getElementById('visibility')) document.getElementById('visibility').textContent = weather.visibility;
    if (document.getElementById('humidity')) document.getElementById('humidity').textContent = weather.humidity;
    if (document.getElementById('wind-speed')) document.getElementById('wind-speed').textContent = weather.windSpeed;
    
    // æ·¡å…¥
    elements.forEach(el => {
      if (el) el.style.opacity = '1';
    });
    
    // ç§»é™¤æ—‹è½¬åŠ¨ç”»
    setTimeout(() => {
      refreshButton.classList.remove('rotating');
    }, 500);
  }, 300);
}

// æ ¹æ®æ—¶é—´è‡ªåŠ¨æ›´æ–°å¤©æ°”
function autoUpdateWeather() {
  const hour = new Date().getHours();
  
  // æ ¹æ®æ—¶é—´è°ƒæ•´æ¸©åº¦ï¼ˆç®€å•æ¨¡æ‹Ÿï¼‰
  if (hour >= 6 && hour < 12) {
    // ä¸Šåˆï¼šæ¸©åº¦é€‚ä¸­
    currentWeatherIndex = Math.floor(Math.random() * 3);
  } else if (hour >= 12 && hour < 18) {
    // ä¸‹åˆï¼šæ¸©åº¦è¾ƒé«˜
    currentWeatherIndex = Math.floor(Math.random() * 2) + 2;
  } else if (hour >= 18 && hour < 22) {
    // å‚æ™šï¼šæ¸©åº¦ä¸‹é™
    currentWeatherIndex = Math.floor(Math.random() * 2) + 4;
  } else {
    // å¤œæ™šï¼šæ¸©åº¦è¾ƒä½
    currentWeatherIndex = Math.floor(Math.random() * 2) + 6;
  }
  
  const weather = weatherData[currentWeatherIndex] || weatherData[0];
  
  // é™é»˜æ›´æ–°ï¼ˆæ— åŠ¨ç”»ï¼‰
  if (document.getElementById('weather-icon')) document.getElementById('weather-icon').textContent = weather.icon;
  if (document.getElementById('weather-temp')) document.getElementById('weather-temp').textContent = weather.temp;
  if (document.getElementById('weather-desc')) document.getElementById('weather-desc').textContent = weather.desc;
  if (document.getElementById('weather-location')) document.getElementById('weather-location').textContent = weather.location;
  if (document.getElementById('visibility')) document.getElementById('visibility').textContent = weather.visibility;
  if (document.getElementById('humidity')) document.getElementById('humidity').textContent = weather.humidity;
  if (document.getElementById('wind-speed')) document.getElementById('wind-speed').textContent = weather.windSpeed;
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
  autoUpdateWeather();
  
  // æ¯30åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°ä¸€æ¬¡å¤©æ°”
  setInterval(autoUpdateWeather, 30 * 60 * 1000);
});
</script>
